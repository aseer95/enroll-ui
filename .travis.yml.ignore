language: node_js
node_js:
  - '12'
install:
  - npm install
cache:
  directories:
    - 'node_modules'
    # we also need to cache folder with Cypress binary
    - ~/.cache
script:
  - npx stylelint "**/*.scss"
  - npm run affected:lint -- --base=origin/master --parallel
  - npm run affected:test -- --base=origin/master --parallel --bail=1
  - npm run affected:e2e -- --base=origin/master --headless --parallel
after_script:
  - ./post_build_results
